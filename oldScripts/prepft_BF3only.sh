#####################################################################################################  
#
# prepft.sh
# Author: Expert Shifters
# Last Edited: April 6th, 2018
#
#####################################################################################################  


#####################################################################################################
# First set the trigger limiter using the following:
# Either uncomment one of the following lines or use or use the following format: regft -191 9f0 XXYYYYYY, where XX is the number of triggers allowed in YYYYYY clock cycles (in hexadecimal). 
#Each clock cycle is 7.8 nanoseconds.

#regft -191 9f0 0100b000  #interval in new FTSW FW 7/18/2017
#regft -191 9f0 0500411b  #5trg/133us interval in new FTSW FW 11/21/2017 - high rate
regft -191 9f0 0100001a   # 1trg/0.2 us
##regft -191 9f0 01000082  # 1trg/1 us
#regft -191 9f0 01000104   # 1trg/2 us
#regft -191 9f0 01000208  # 1trg/4 us
#regft -191 9f0 0100028a  # 1trg/5 us
#regft -191 9f0 0100030c # 1trg/6 us
#regft -191 9f0 01000410 # 1trg/8 us
#regft -191 9f0 01000514  # 1trg/10 us
#regft -191 9f0 0100079e   # 1trg/15 us
#regft -191 9f0 01000a28   # 1trg/20 us
#regft -191 9f0 0c00b000  # 12trg/351us for test
#regft -191 9f0 0102ef33  # 1trg/1500us
#regft -191 9f0 0100320c # 1trg/100us
#regft -191 9f0 0100411b  # 1trg/133us
#regft -191 9f0 01006429  # 1trg/200us
#####################################################################################################
#####################################################################################################


#####################################################################################################  
# DO NOT TOUCH THIS PART, it deals with the lookback window and trigger...
#####################################################################################################
#regft -191 9e0 02290000                                                                                                                                                                                          
#regft -191 9e0 02160000 #6/1/17- Isar delay in new FTSW FW 7/18/2017 
regft -191 9e0 00c80000 #19/Mar/2018, dealy 00c8 is suitable for lookback window [0x300,0x14C]. we can set [0x300,0x14C] for both local and global mode 
utimeft -191
ttaddr -191 -c
ttaddr -191 -a 
#####################################################################################################
#####################################################################################################

#####################################################################################################
###################EDIT THIS TO MASK OR UNMASK SECTORS################################################################################
#####################################################################################################
#ttaddr -191 -u dc38,s153,s154 #only engaging DC10- BF2 only
#ttaddr -191 -u dc12,s160,s161 #only engaging DC12- bfl
#ttaddr -191 -u dc12,s160,s161,dc19,s051,s075 #BF 6,1
#ttaddr -191 -u dc19,s051,s075 #only engaging DC19- bfl
#ttaddr -191 -u dc38,s153,s154,dc12,s160,s161 #only  DC10,DC12
#ttaddr -191 -u dc38,s153,s154,dc16,s117,s118 #only  BF2,BF3
#ttaddr -191 -u dc38,s153,s154,dc16,s117,s118,dc17,s156,s157 #BF2,3,4

#ttaddr -191 -u dc38,s153,s154,dc16,s117,s118,dc17,s156,s157,dc18,s158,s159,dc12,s160,s161,dc19,s051,s075,dc20,s092,s104,dc13,s150,s152 #BF2,3,4,5, 6,7,0,1
#ttaddr -191 -u dc46,dc24,dc25,dc26,s113,s116,s103,s107,s108,s109,s110,s112,dc27,dc29,dc21,dc22,s095,s097,s094,s093,s102,s098,s099,s101 #BB2,3,4,5, 6,7,0,1

###########################################################################################################################################################
#ALL BARREL KLM LAYERS:
ttaddr -191 -u dc16,s117,s118
###########################################################################################################################################################

#All barrel but BB6,BB7
#ttaddr -191 -u dc38,s153,s154,dc16,s117,s118,dc17,s156,s157,dc18,s158,s159,dc12,s160,s161,dc19,s051,s075,dc20,s092,s104,dc13,s150,s152,dc46,dc24,dc25,dc26,s113,s116,s103,s107,s108,s109,s110,s112,dc21,dc22,s102,s098,s099,s101

#All barrel but BB6,BB7,BB0
#ttaddr -191 -u dc38,s153,s154,dc16,s117,s118,dc17,s156,s157,dc18,s158,s159,dc12,s160,s161,dc19,s051,s075,dc20,s092,s104,dc13,s150,s152,dc46,dc24,dc25,dc26,s113,s116,s103,s107,s108,s109,s110,s112,dc22,s099,s101

#all barrel except BF2 (exluded for standalone debug)
#ttaddr -191 -u dc16,s117,s118,dc17,s156,s157,dc18,s158,s159,dc12,s160,s161,dc19,s051,s075,dc20,s092,s104,dc13,s150,s152,dc46,dc24,dc25,dc26,s113,s116,s103,s107,s108,s109,s110,s112,dc27,dc29,dc21,dc22,s095,s097,s094,s093,s102,s098,s099,s101

#all barrel exept BF5 (cpr 7001-d)
#ttaddr -191 -u dc38,s153,s154,dc16,s117,s118,dc17,s156,s157,dc12,s160,s161,dc19,s051,s075,dc20,s092,s104,dc13,s150,s152,dc46,dc24,dc25,dc26,s113,s116,s103,s107,s108,s109,s110,s112,dc27,dc29,dc21,dc22,s095,s097,s094,s093,s102,s098,s099,s101
#ttaddr -191 -m dc18

#All barrel excep BF1
#ttaddr -191 -u dc38,s153,s154,dc16,s117,s118,dc17,s156,s157,dc18,s158,s159,dc19,s051,s075,dc20,s092,s104,dc13,s150,s152,dc46,dc24,dc25,dc26,s113,s116,s103,s107,s108,s109,s110,s112,dc27,dc29,dc21,dc22,s095,s097,s094,s093,s102,s098,s099,s101

#All barrel excep BF1, BF0
#ttaddr -191 -u dc38,s153,s154,dc16,s117,s118,dc17,s156,s157,dc18,s158,s159,dc19,s051,s075,dc20,s092,s104,dc46,dc24,dc25,dc26,s113,s116,s103,s107,s108,s109,s110,s112,dc27,dc29,dc21,dc22,s095,s097,s094,s093,s102,s098,s099,s101

#All barrel excep BF1, BB1
#ttaddr -191 -u dc38,s153,s154,dc16,s117,s118,dc17,s156,s157,dc18,s158,s159,dc19,s051,s075,dc20,s092,s104,dc13,s150,s152,dc46,dc24,dc25,dc26,s113,s116,s103,s107,s108,s109,s110,s112,dc27,dc29,dc21,s095,s097,s094,s093,s102,s098

#ttaddr -191 -u dc12,s160,s161,dc19,s051,s075,dc20,s092,s104,dc13,s150,s152 #6,7,0,1
#ttaddr -191 -u dc20,s092,s104 #BF7
#ttaddr -191 -u dc16,s117,s118,dc17,s156,s157,dc18,s158,s159 #BF3,4,5
###########################################################################################################################################################
###########################################################################################################################################################

trigft -191 reset
